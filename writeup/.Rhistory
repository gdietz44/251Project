###Data Preparation
####Load Relevant Libraries and Functions
library(tidyr)
library(ggplot2)
library(dplyr)
####Import data
# read csv file
raw_data = read.csv("../mturk/pilotB-results.csv")
#### Data exclusion / filtering
#### Prepare data for analysis - create columns etc.
# gather function (on each line: subject id, gender, score for one trial)
tidy_data = raw_data %>%
select(-starts_with("answer_")) %>%
gather(corner, correct, -c("participant", "condition", "sex", "cs_experience")) %>%
mutate(corner = substr(corner,9,9))
# group by and summarise
summary_data = tidy_data %>%
group_by(participant, condition, sex, cs_experience) %>%
summarise(score = sum(correct))
anova <- aov(score ~ sex * condition, data = summary_data)
summary(anova)
graph_data = summary_data %>%
group_by(condition, sex) %>%
summarise(mean = mean(score), ci = 1.96*(sd(score)/sqrt(n())))
graph_data$condition <- factor(graph_data$condition, levels = c('spatial','social'))
ggplot(graph_data, aes(x=sex, y=mean, fill=condition)) +
geom_bar(position="dodge", stat="identity") +
theme_bw() +
ylim(0, 30) +
ylab("Mean Number Correct") +
theme(axis.title.x = element_blank()) +
scale_x_discrete(limits=c('M','F'), labels=c('Males','Females')) +
scale_fill_manual(values=c("#8C8E90","#E2E3E4"),name='Conditions',limits=c('spatial','social'),labels=c('Spatial Condition','Social Condition')) +
geom_errorbar(aes(ymin=mean-ci,ymax=mean+ci),width=0.2,position=position_dodge(.9))
###T-Tests
####Female Score By Condition
female_data = summary_data %>%
subset(sex=='F')
female_by_condition <- t.test(score ~ condition, data = female_data)
ggplot(raw_data, aes(x=sex)) %>%
geom_histogram()
ggplot(raw_data, aes(x=sex)) +
geom_histogram()
ggplot(raw_data, aes(x=sex)) +
geom_histogram(stat="count")
ggplot(summary_data, aes(x=score)) +
geom_histogram(stat="count")
###T-Tests
####Female Score By Condition
female_data = summary_data %>%
subset(sex=='F')
female_by_condition <- t.test(score ~ condition, data = female_data)
####Male Score By Condition
male_data = summary_data %>%
subset(sex=='M')
male_by_condition <- t.test(score ~ condition, data = male_data)
summary(male_by_condition)
####Spatial Score By Sex
spatial_data = summary_data %>%
subset(condition=='spatial')
spatial_by_sex <- t.test(score ~ sex, data = spatial_data)
summary(spatial_by_sex)
####Social Score By Sex
social_data = summary_data %>%
subset(condition=='social')
social_by_sex <- t.test(score ~ sex, data = social_data)
summary(social_by_sex)
###CS Experience
cs_anova <- aov(score ~ sex * cs_experience, data = summary_data)
summary(cs_anova)
###CS Experience
cs_anova <- aov(score ~ sex * condition * cs_experience, data = summary_data)
summary(cs_anova)
###Data Preparation
####Load Relevant Libraries and Functions
library(tidyr)
library(ggplot2)
library(dplyr)
####Import data
# read csv file
raw_data = read.csv("../mturk/pilotB-results.csv")
#### Data exclusion / filtering
#### Prepare data for analysis - create columns etc.
# gather function (on each line: subject id, gender, score for one trial)
tidy_data = raw_data %>%
select(-starts_with("answer_")) %>%
gather(corner, correct, -c("participant", "condition", "sex", "cs_experience")) %>%
mutate(corner = substr(corner,9,9))
# group by and summarise
summary_data = tidy_data %>%
group_by(participant, condition, sex, cs_experience) %>%
summarise(score = sum(correct))
ggplot(raw_data, aes(x=sex)) +
geom_histogram(stat="count")
ggplot(summary_data, aes(x=score)) +
geom_histogram(stat="count")
anova <- aov(score ~ sex * condition, data = summary_data)
summary(anova)
graph_data = summary_data %>%
group_by(condition, sex) %>%
summarise(mean = mean(score), ci = 1.96*(sd(score)/sqrt(n())))
graph_data$condition <- factor(graph_data$condition, levels = c('spatial','social'))
ggplot(graph_data, aes(x=sex, y=mean, fill=condition)) +
geom_bar(position="dodge", stat="identity") +
theme_bw() +
ylim(0, 30) +
ylab("Mean Number Correct") +
theme(axis.title.x = element_blank()) +
scale_x_discrete(limits=c('M','F'), labels=c('Males','Females')) +
scale_fill_manual(values=c("#8C8E90","#E2E3E4"),name='Conditions',limits=c('spatial','social'),labels=c('Spatial Condition','Social Condition')) +
geom_errorbar(aes(ymin=mean-ci,ymax=mean+ci),width=0.2,position=position_dodge(.9))
